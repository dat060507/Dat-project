<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>EcoCart Demo</title>
<style>
body { font-family: Arial; padding:20px; background:#f3f3f3; color:#000; transition:0.3s;}
body.dark { background:#121212; color:#fff;}
h1{text-align:center;}
.controls {text-align:center;margin-bottom:20px;}
button{padding:5px 10px;margin:5px;border-radius:6px;cursor:pointer;}
.container{display:flex;gap:20px;flex-wrap:wrap;justify-content:center;}
.products,.cart{background:rgba(255,255,255,0.9);padding:20px;border-radius:12px;box-shadow:0 4px 8px rgba(0,0,0,0.2);color:#000;}
body.dark .products,body.dark .cart{background:rgba(30,30,30,0.9);color:#fff;}
.product-card,.cart-item{display:flex;gap:10px;border-bottom:1px solid #ddd;padding:10px;align-items:center;border-radius:8px;background:rgba(200,255,200,0.3);}
body.dark .product-card,body.dark .cart-item{border-bottom:1px solid #444;}
.product-card img,.cart-item img{width:80px;height:80px;object-fit:cover;border-radius:8px;}
.product-details{flex:1;}
.price{font-weight:bold;color:#1b5e20;}
body.dark .price{color:#81c784;}
.quantity-control{display:flex;align-items:center;gap:5px;margin-top:5px;}
.cart-total{font-weight:bold;margin-top:15px;text-align:right;color:#2e7d32;}
body.dark .cart-total{color:#81c784;}
.pay-button{width:100%;padding:10px;margin-top:10px;font-weight:bold;background:#4caf50;color:#fff;border:none;border-radius:8px;cursor:pointer;}
.pay-button:hover{background:#388e3c;}
</style>
</head>
<body>

<h1>EcoCart Demo</h1>

<div class="controls">
<button onclick="toggleDarkMode()">Toggle Dark/Light Mode</button>
</div>

<div class="container">
<div class="products" id="productsContainer"></div>
<div class="cart">
<h2>Your Cart</h2>
<div id="cartItems"></div>
<div class="cart-total" id="cartTotal">Total: $0.00</div>
<button class="pay-button" onclick="goToPayment()">Pay Online</button>
</div>
</div>

<script>
let productsData=[
{name:"Apple", price:2.00, img:"https://upload.wikimedia.org/wikipedia/commons/1/15/Red_Apple.jpg", discount:10},
{name:"Banana", price:1.50, img:"https://upload.wikimedia.org/wikipedia/commons/8/8a/Banana-Single.jpg", discount:5},
{name:"Milk", price:3.00, img:"https://media.istockphoto.com/id/1206080627/photo/glass-of-milk.jpg?s=612x612&w=0&k=20&c=h4ElcpQ3l7mL-3ssXIj-Cl_nlW0j1sWgyKvYRoipdM0=", discount:15}
];

let cart=[];

function renderProducts(){
    const container=document.getElementById('productsContainer');
    container.innerHTML='';
    productsData.forEach(prod=>{
        let discountedPrice=(prod.price*(1-prod.discount/100)).toFixed(2);
        let div=document.createElement('div');
        div.className='product-card';
        div.innerHTML=`
            <img src="${prod.img}">
            <div class="product-details">
                <div>${prod.name}</div>
                <div class="price">$${discountedPrice} (-${prod.discount}%)</div>
                <div class="quantity-control">
                    <button onclick="changeQuantity(this,-1)">-</button>
                    <input type="number" value="1" min="0" style="width:40px;text-align:center;" readonly>
                    <button onclick="changeQuantity(this,1)">+</button>
                </div>
            </div>
        `;
        container.appendChild(div);
    });
}

function changeQuantity(btn,delta){
    let input=btn.parentElement.querySelector('input');
    let val=parseInt(input.value)+delta;
    if(val<0) val=0;
    input.value=val;
}

function toggleDarkMode(){
    document.body.classList.toggle('dark');
    localStorage.setItem('darkMode',document.body.classList.contains('dark'));
}

function goToPayment(){
    cart=[];
    const cards=document.querySelectorAll('.product-card');
    cards.forEach((card,index)=>{
        let qty=parseInt(card.querySelector('input').value);
        if(qty>0){
            let prod=productsData[index];
            let discountedPrice=parseFloat((prod.price*(1-prod.discount/100)).toFixed(2));
            cart.push({name:prod.name, quantity:qty, total:discountedPrice*qty, img:prod.img});
        }
    });
    if(cart.length===0){alert("Cart is empty!"); return;}
    localStorage.setItem('currentCart',JSON.stringify(cart));
    let totalAmount=cart.reduce((sum,item)=>sum+item.total,0);
    window.location.href=`payment.html?amount=${totalAmount.toFixed(2)}`;
}

renderProducts();
if(localStorage.getItem('darkMode')==='true') document.body.classList.add('dark');
</script>
</body>
</html>
